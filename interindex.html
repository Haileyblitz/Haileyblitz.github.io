
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PING PONG</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Bebas+Neue&display=swap');

  :root {
    --pink:  #ff2d78;
    --pink2: #ff79b0;
    --pink3: #ffc2d9;
    --dark:  #140008;
    --darker:#0a0005;
    --mid:   #3d0020;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--darker);
    background-image: radial-gradient(ellipse at 50% 0%, #3d001888 0%, transparent 65%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    overflow: hidden;
    font-family: 'Share Tech Mono', monospace;
    color: var(--pink3);
  }

  h1 {
    font-family: 'Bebas Neue', cursive;
    font-size: 3rem;
    letter-spacing: 0.35em;
    color: var(--pink);
    text-shadow: 0 0 20px #ff2d7899, 0 0 50px #ff2d7844;
    margin-bottom: 8px;
  }

  #info-bar {
    display: flex;
    gap: 28px;
    margin-bottom: 10px;
    font-size: 0.72rem;
    letter-spacing: 0.15em;
    color: #5a1030;
  }
  #info-bar span { color: #a0406a; }

  #scoreboard {
    display: flex;
    gap: 60px;
    align-items: center;
    font-size: 2.5rem;
    font-family: 'Bebas Neue', cursive;
    letter-spacing: 0.15em;
    margin-bottom: 12px;
  }
  #playerScore { color: var(--pink2); text-shadow: 0 0 14px #ff79b099; }
  #cpuScore    { color: var(--pink);  text-shadow: 0 0 14px #ff2d7899; }
  .sep         { color: var(--mid); font-size: 2rem; }

  #canvasWrapper {
    position: relative;
    border: 2px solid #ff2d7833;
    box-shadow: 0 0 50px #ff2d7822, inset 0 0 60px #1a0010;
    border-radius: 4px;
  }

  canvas { display: block; }

  /* â”€â”€ Setup overlay â”€â”€ */
  #setup {
    position: absolute;
    inset: 0;
    background: rgba(10,0,5,0.94);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 24px;
    border-radius: 3px;
  }

  #setup h2 {
    font-family: 'Bebas Neue', cursive;
    font-size: 2rem;
    letter-spacing: 0.3em;
    color: var(--pink);
    text-shadow: 0 0 16px #ff2d7877;
  }

  .setup-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .setup-label {
    font-size: 0.68rem;
    letter-spacing: 0.2em;
    color: var(--pink3);
    opacity: 0.6;
  }

  .btn-group { display: flex; gap: 10px; }

  .diff-btn {
    font-family: 'Bebas Neue', cursive;
    font-size: 1.3rem;
    letter-spacing: 0.15em;
    padding: 8px 24px;
    background: transparent;
    border: 2px solid var(--mid);
    color: #a0406a;
    cursor: pointer;
    border-radius: 3px;
    transition: all 0.18s;
  }
  .diff-btn:hover, .diff-btn.active {
    border-color: var(--pink);
    color: #fff;
    background: #ff2d7822;
    text-shadow: 0 0 10px var(--pink);
    box-shadow: 0 0 14px #ff2d7844;
  }

  .pts-group { display: flex; gap: 10px; align-items: center; }

  .pts-btn {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.9rem;
    padding: 7px 16px;
    background: transparent;
    border: 2px solid var(--mid);
    color: #a0406a;
    cursor: pointer;
    border-radius: 3px;
    transition: all 0.18s;
  }
  .pts-btn:hover, .pts-btn.active {
    border-color: var(--pink2);
    color: #fff;
    background: #ff79b022;
    box-shadow: 0 0 10px #ff79b033;
  }

  #startBtn {
    font-family: 'Bebas Neue', cursive;
    font-size: 1.6rem;
    letter-spacing: 0.3em;
    padding: 12px 52px;
    background: linear-gradient(135deg, #c2185b, #ff2d78);
    border: none;
    color: #fff;
    cursor: pointer;
    border-radius: 3px;
    text-shadow: 0 0 10px #fff5;
    box-shadow: 0 0 24px #ff2d7866;
    transition: all 0.18s;
    margin-top: 6px;
  }
  #startBtn:hover {
    box-shadow: 0 0 42px #ff2d78aa;
    transform: scale(1.04);
  }

  /* â”€â”€ In-game overlay â”€â”€ */
  #msg {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-family: 'Bebas Neue', cursive;
    font-size: 2.6rem;
    letter-spacing: 0.2em;
    color: #fff;
    text-shadow: 0 0 20px var(--pink);
    pointer-events: none;
    text-align: center;
    line-height: 1.4;
    display: none;
  }

  #hint {
    margin-top: 10px;
    font-size: 0.7rem;
    color: #5a1030;
    letter-spacing: 0.15em;
  }

  /* â”€â”€ Floating hearts â”€â”€ */
  #hearts {
    position: fixed;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 0;
  }
  .heart {
    position: absolute;
    bottom: -60px;
    font-size: 1.4rem;
    opacity: 0;
    animation: floatHeart linear infinite;
    user-select: none;
  }
  @keyframes floatHeart {
    0%   { transform: translateY(0) scale(0.8) rotate(-8deg); opacity: 0; }
    8%   { opacity: 0.22; }
    85%  { opacity: 0.12; }
    100% { transform: translateY(-110vh) scale(1.1) rotate(8deg); opacity: 0; }
  }
  body > *:not(#hearts) { position: relative; z-index: 1; }
</style>
</head>
<body>

<div id="hearts"></div>
<h1>PING PONG ðŸ©·</h1>

<div id="info-bar">
  DIFFICULTY: <span id="infoLevel">â€”</span> &nbsp;Â·&nbsp; FIRST TO <span id="infoWin">â€”</span> PTS
</div>

<div id="scoreboard">
  <span id="playerScore">00</span>
  <span class="sep">:</span>
  <span id="cpuScore">00</span>
</div>

<div id="canvasWrapper">
  <canvas id="c"></canvas>

  <div id="setup">
    <h2>NEW GAME</h2>

    <div class="setup-row">
      <div class="setup-label">DIFFICULTY</div>
      <div class="btn-group">
        <button class="diff-btn" data-diff="easy">EASY</button>
        <button class="diff-btn active" data-diff="medium">MEDIUM</button>
        <button class="diff-btn" data-diff="hard">HARD</button>
      </div>
    </div>

    <div class="setup-row">
      <div class="setup-label">POINTS TO WIN</div>
      <div class="pts-group">
        <button class="pts-btn" data-pts="3">3</button>
        <button class="pts-btn active" data-pts="7">7</button>
        <button class="pts-btn" data-pts="11">11</button>
        <button class="pts-btn" data-pts="21">21</button>
      </div>
    </div>

    <button id="startBtn">START GAME</button>
  </div>

  <div id="msg"></div>
</div>

<div id="hint">â†‘ â†“ ARROW KEYS TO MOVE &nbsp;Â·&nbsp; SPACE TO CONTINUE &nbsp;Â·&nbsp; R TO RESTART</div>

<script>
const canvas = document.getElementById('c');
const ctx    = canvas.getContext('2d');
const msgEl  = document.getElementById('msg');
const setupEl= document.getElementById('setup');

const W = 800, H = 500;
canvas.width = W; canvas.height = H;

const PAD_W = 12, PAD_H = 80, BALL_R = 8, PAD_SPEED = 6;

const DIFFICULTY = {
  easy:   { cpuSpeed: 2.6, errorMargin: 50, reactionZone: 0.35 },
  medium: { cpuSpeed: 4.5, errorMargin: 18, reactionZone: 0.65 },
  hard:   { cpuSpeed: 7.5, errorMargin: 3,  reactionZone: 1.0  }
};

let chosenDiff = 'medium';
let winScore   = 7;
let cpuCfg     = DIFFICULTY[chosenDiff];

let state = 'setup';
let keys  = {};
let playerScore = 0, cpuScore = 0;

const player = { x: 20,          y: H/2 - PAD_H/2 };
const cpu    = { x: W-20-PAD_W,  y: H/2 - PAD_H/2 };
const ball   = { x: W/2, y: H/2, vx: 0, vy: 0, trail: [] };
let sparks   = [];

// â”€â”€ Setup UI â”€â”€
document.querySelectorAll('.diff-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    chosenDiff = btn.dataset.diff;
  });
});
document.querySelectorAll('.pts-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.pts-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    winScore = parseInt(btn.dataset.pts);
  });
});
document.getElementById('startBtn').addEventListener('click', startGame);

function startGame() {
  cpuCfg = DIFFICULTY[chosenDiff];
  playerScore = 0; cpuScore = 0;
  updateScore();
  document.getElementById('infoLevel').textContent = chosenDiff.toUpperCase();
  document.getElementById('infoWin').textContent   = winScore;
  player.y = H/2 - PAD_H/2;
  cpu.y    = H/2 - PAD_H/2;
  sparks   = [];
  resetBall(1);
  setupEl.style.display = 'none';
  hideMsg();
  state = 'playing';
}

// â”€â”€ Helpers â”€â”€
function resetBall(dir) {
  ball.x = W/2; ball.y = H/2;
  const a = (Math.random()*0.6 - 0.3);
  const s = 5;
  ball.vx = dir * s * Math.cos(a);
  ball.vy = s * Math.sin(a);
  ball.trail = [];
}

function updateScore() {
  document.getElementById('playerScore').textContent = String(playerScore).padStart(2,'0');
  document.getElementById('cpuScore').textContent    = String(cpuScore).padStart(2,'0');
}

function showMsg(html) { msgEl.innerHTML = html; msgEl.style.display = 'block'; }
function hideMsg()     { msgEl.style.display = 'none'; }

function addSparks(x, y) {
  for(let i=0;i<12;i++){
    const a=Math.random()*Math.PI*2, s=2+Math.random()*5;
    sparks.push({x,y,vx:Math.cos(a)*s,vy:Math.sin(a)*s,life:1});
  }
}

// â”€â”€ Update â”€â”€
function update() {
  if(state !== 'playing') return;

  // Player
  if(keys['ArrowUp'])   player.y -= PAD_SPEED;
  if(keys['ArrowDown']) player.y += PAD_SPEED;
  player.y = Math.max(0, Math.min(H-PAD_H, player.y));

  // CPU AI
  if(ball.vx > 0 && ball.x > W*(1-cpuCfg.reactionZone)) {
    const center = cpu.y + PAD_H/2;
    const target = ball.y + (Math.random()-0.5)*cpuCfg.errorMargin;
    const diff   = target - center;
    if(Math.abs(diff) > 4)
      cpu.y += Math.sign(diff) * Math.min(cpuCfg.cpuSpeed, Math.abs(diff));
  }
  cpu.y = Math.max(0, Math.min(H-PAD_H, cpu.y));

  // Ball
  ball.trail.push({x:ball.x, y:ball.y});
  if(ball.trail.length > 14) ball.trail.shift();
  ball.x += ball.vx;
  ball.y += ball.vy;

  // Walls
  if(ball.y-BALL_R < 0) { ball.y=BALL_R;   ball.vy*=-1; }
  if(ball.y+BALL_R > H) { ball.y=H-BALL_R; ball.vy*=-1; }

  // Player paddle
  if(ball.vx < 0 &&
     ball.x-BALL_R < player.x+PAD_W && ball.x-BALL_R > player.x &&
     ball.y > player.y-BALL_R && ball.y < player.y+PAD_H+BALL_R) {
    ball.x = player.x+PAD_W+BALL_R;
    const rel = (ball.y-(player.y+PAD_H/2))/(PAD_H/2);
    const spd = Math.min(Math.hypot(ball.vx,ball.vy)*1.05, 18);
    ball.vx =  spd * Math.cos(rel*0.9);
    ball.vy =  spd * Math.sin(rel*0.9);
    addSparks(ball.x, ball.y);
  }

  // CPU paddle
  if(ball.vx > 0 &&
     ball.x+BALL_R > cpu.x && ball.x+BALL_R < cpu.x+PAD_W &&
     ball.y > cpu.y-BALL_R && ball.y < cpu.y+PAD_H+BALL_R) {
    ball.x = cpu.x-BALL_R;
    const rel = (ball.y-(cpu.y+PAD_H/2))/(PAD_H/2);
    const spd = Math.min(Math.hypot(ball.vx,ball.vy)*1.05, 18);
    ball.vx = -spd * Math.cos(rel*0.9);
    ball.vy =  spd * Math.sin(rel*0.9);
    addSparks(ball.x, ball.y);
  }

  // Scoring
  if(ball.x < 0) {
    cpuScore++; updateScore();
    if(cpuScore >= winScore) {
      state='over';
      showMsg(`CPU WINS<br><span style="font-size:1.1rem;color:#ff2d78;">R â€” NEW GAME</span>`);
      return;
    }
    state='paused';
    showMsg(`POINT CPU<br><span style="font-size:1rem;color:#5a1030;">SPACE TO CONTINUE</span>`);
    resetBall(1);
  }
  if(ball.x > W) {
    playerScore++; updateScore();
    if(playerScore >= winScore) {
      state='over';
      showMsg(`YOU WIN!<br><span style="font-size:1.1rem;color:#ff79b0;">R â€” NEW GAME</span>`);
      return;
    }
    state='paused';
    showMsg(`YOUR POINT<br><span style="font-size:1rem;color:#5a1030;">SPACE TO CONTINUE</span>`);
    resetBall(-1);
  }

  // Sparks
  sparks = sparks.filter(s => s.life > 0);
  sparks.forEach(s => { s.x+=s.vx; s.y+=s.vy; s.vx*=0.88; s.vy*=0.88; s.life-=0.06; });
}

// â”€â”€ Draw â”€â”€
function drawPaddle(x, y, c1, c2) {
  ctx.save();
  ctx.shadowColor = c2; ctx.shadowBlur = 20;
  const g = ctx.createLinearGradient(x,y,x,y+PAD_H);
  g.addColorStop(0,c1); g.addColorStop(1,c2);
  ctx.fillStyle = g;
  ctx.beginPath(); ctx.roundRect(x,y,PAD_W,PAD_H,4); ctx.fill();
  ctx.restore();
}

function draw() {
  ctx.fillStyle = '#0a0005';
  ctx.fillRect(0,0,W,H);

  // Vignette
  const v = ctx.createRadialGradient(W/2,H/2,H*0.3, W/2,H/2,H*0.85);
  v.addColorStop(0,'transparent');
  v.addColorStop(1,'rgba(80,0,30,0.4)');
  ctx.fillStyle = v; ctx.fillRect(0,0,W,H);

  // Center dashes
  ctx.setLineDash([10,14]);
  ctx.strokeStyle='#ff2d7818'; ctx.lineWidth=2;
  ctx.beginPath(); ctx.moveTo(W/2,0); ctx.lineTo(W/2,H); ctx.stroke();
  ctx.setLineDash([]);

  // Center circle
  ctx.beginPath(); ctx.arc(W/2,H/2,50,0,Math.PI*2);
  ctx.strokeStyle='#ff2d780b'; ctx.lineWidth=2; ctx.stroke();

  // Trail
  ball.trail.forEach((p,i) => {
    const t = i/ball.trail.length;
    ctx.beginPath(); ctx.arc(p.x,p.y,BALL_R*t,0,Math.PI*2);
    ctx.fillStyle=`rgba(255,121,176,${t*0.3})`; ctx.fill();
  });

  // Ball
  ctx.save();
  ctx.shadowColor='#ff2d78'; ctx.shadowBlur=26;
  const bg=ctx.createRadialGradient(ball.x-2,ball.y-2,1, ball.x,ball.y,BALL_R);
  bg.addColorStop(0,'#fff'); bg.addColorStop(1,'#ff2d78');
  ctx.fillStyle=bg;
  ctx.beginPath(); ctx.arc(ball.x,ball.y,BALL_R,0,Math.PI*2); ctx.fill();
  ctx.restore();

  // Paddles
  drawPaddle(player.x, player.y, '#ff79b0','#ff2d78');
  drawPaddle(cpu.x,    cpu.y,    '#c2185b','#7b0030');

  // Sparks
  sparks.forEach(s => {
    ctx.beginPath(); ctx.arc(s.x,s.y,2,0,Math.PI*2);
    ctx.fillStyle=`rgba(255,200,220,${s.life})`; ctx.fill();
  });
}

function loop() { update(); draw(); requestAnimationFrame(loop); }

// â”€â”€ Input â”€â”€
document.addEventListener('keydown', e => {
  keys[e.key] = true;
  if(['ArrowUp','ArrowDown',' '].includes(e.key)) e.preventDefault();

  if(e.key === ' ' && state === 'paused') {
    state = 'playing'; hideMsg();
  }
  if(e.key.toLowerCase() === 'r' && state === 'over') {
    setupEl.style.display = 'flex';
    hideMsg();
    state = 'setup';
  }
});
document.addEventListener('keyup', e => { keys[e.key] = false; });

// â”€â”€ Boot â”€â”€
updateScore();
loop();

// â”€â”€ Floating hearts â”€â”€
(function() {
  const container = document.getElementById('hearts');
  const emojis = ['ðŸ©·','ðŸ’—','ðŸ’“','ðŸ’•','ðŸ©·','ðŸ’–','ðŸ©·','ðŸ’—'];
  for(let i = 0; i < 22; i++) {
    const h = document.createElement('span');
    h.className = 'heart';
    h.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    h.style.left = Math.random()*100 + 'vw';
    h.style.fontSize = (0.9 + Math.random()*1.4) + 'rem';
    h.style.animationDuration = (9 + Math.random()*16) + 's';
    h.style.animationDelay = -(Math.random()*20) + 's';
    container.appendChild(h);
  }
})();
</script>
</body>
</html>
